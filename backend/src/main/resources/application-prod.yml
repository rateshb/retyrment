# Production Configuration for Retyrment
# All sensitive values should come from environment variables

spring:
  data:
    mongodb:
      uri: ${MONGO_URI:mongodb://172.31.9.182:27017}
      database: ${MONGO_DATABASE:retyrment_prod}
      auto-index-creation: false  # Indexes should be created via migration scripts
  
  # OAuth2 Configuration - Use production credentials
  security:
    oauth2:
      client:
        registration:
          google:
            client-id: 176349050677-3tl9bknedujcl9qqq3vfr7phdmkvo9pr.apps.googleusercontent.com
            client-secret: Oa7ulLInCJLhzTbv7jP-oG21
            scope:
              - email
              - profile

# Server configuration
server:
  tomcat:
# This regex allows all IP addresses to be trusted as proxies.
# Replace with your specific Nginx IP if you want to be more secure.
    remote-ip-header: x-forwarded-for
    protocol-header: x-forwarded-proto
    internal-proxies: ".*"
  port: 8081
  servlet:
    context-path: /api
    session:
      cookie:
        # Give this a unique name so it doesn't conflict with your port 3000 app
        name: RETYRMENT_SESSION 
        path: /
        http-only: true
        secure: true # Essential for HTTPS
  forward-headers-strategy: native
  
  # Enable compression for better performance
  compression:
    enabled: true
    mime-types: application/json,application/xml,text/html,text/xml,text/plain
    min-response-size: 1024
  
  # SSL Configuration (uncomment when using HTTPS)
  # ssl:
  #   key-store: classpath:keystore.p12
  #   key-store-password: ${SSL_KEYSTORE_PASSWORD}
  #   key-store-type: PKCS12
  #   key-alias: retyrment
  
  # Error handling - don't expose stack traces
  error:
    include-stacktrace: never
    include-message: never

# Application settings
app:
  name: Retyrment
  version: 1.0.0
  
  # JWT Settings - MUST be set via environment variable in production
  jwt:
    secret: a0a2abd8-6162-41c3-83d6-1cf559b46afc
    expiration: 86400000  # 24 hours
  
  # Frontend URL
  frontend-url: ${FRONTEND_URL:https://retyrment.com}
  
  # Admin emails
  admin:
    emails: ${ADMIN_EMAILS:bansalitadvisory@gmail.com}
  
  # CORS - Only allow specific origins
  cors:
    allowed-origins: ${CORS_ORIGINS:https://retyrment.com,https://www.retyrment.com}
    allowed-methods: GET,POST,PUT,DELETE,OPTIONS
    allowed-headers: "*"

# Logging - Production level
logging:
  level:
    root: WARN
    com.retyrment: DEBUG
    org.springframework.security: DEBUG
    org.springframework.web: DEBUG
    org.mongodb: WARN
  
  # Log to file in production
  file:
    name: logs/retyrment.log
  
  # Log pattern
  pattern:
    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"

# Actuator endpoints for monitoring
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
      base-path: /actuator
  endpoint:
    health:
      show-details: when_authorized
  info:
    env:
      enabled: true


# Info endpoint data
info:
  app:
    name: ${app.name}
    version: ${app.version}
    environment: production
